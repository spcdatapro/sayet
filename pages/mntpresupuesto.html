<style>
    .tipo {
        font-size: 9pt !important;
    }

    .bld {
        font-weight: bold;
    }

    .presAprobado {
        background-color: #C9F1C9;
    }

    .presPendiente {
        background-color: #F7C5AA;
    }
    /*.app-modal-window .modal-dialog { width: 1000px; }*/
</style>
<div class="container" ng-controller="presupuestoCtrl">
    <ul class="nav nav-tabs">
        <li class="active">
            <a show-tab href="#divLstPresup" data-toggle="tab">LISTA DE &Oacute;RDENES DE TRABAJO</a>
        </li>
        <li>
            <a show-tab href="#divFrmPresup" data-toggle="tab">ORDEN DE TRABAJO</a>
        </li>
        <li ng-show="+presupuesto.id > 0">
            <a show-tab href="#divDetPresup" data-toggle="tab">DETALLE</a>
        </li>
        <li ng-show="+presupuesto.id > 0">
            <a show-tab href="#divAdjuntos" data-toggle="tab">ADJUNTOS</a>
        </li>
        <!--<li ng-show="+presupuesto.id > 0 && +ot.id > 0">
            <a show-tab href="#divDocumentos" data-toggle="tab">DOCUMENTOS</a>
        </li>-->
        <li ng-show="+presupuesto.id > 0 && +ot.id > 0">
            <a show-tab href="#divTranBan" data-toggle="tab">TRANSACCIONES BANCARIAS</a>
        </li>
        <li ng-show="+presupuesto.id > 0 && +ot.id > 0">
            <a show-tab href="#divGenPagos" data-toggle="tab">GENERACIÓN DE PAGOS</a>
        </li>
    </ul>

    <div class="tab-content">
        <div id="divLstPresup" class="tab-pane fade in active">
            <div class="panel panel-info">
                <div class="panel-heading">Lista de &oacute;rdenes de trabajo<button class="btn btn-primary btn-sm"
                        ng-click="tryNotify()" ng-show="false"><i class="fa fa-comments-o"
                            aria-hidden="true"></i></button></div>
                <div class="panel-body">
                    <table class="table table-condensed table-hover tipo">
                        <caption>
                            <form name="frmBusqueda" class="form-inline">
                                <label for="srchTxtDel">Del:</label>
                                <input name="srchTxtDel" id="srchTxtDel" type="date" class="form-control input-sm"
                                    ng-model="fltrot.fdel" required />
                                <label for="srchTxtAl">al:</label>
                                <div class="input-group">
                                    <input name="srchTxtAl" id="srchTxtAl" type="date" class="form-control input-sm"
                                        ng-model="fltrot.fal" required />
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-primary btn-sm"
                                            ng-click="getLstPresupuestos()" ng-disabled="frmBusqueda.$invalid"><i
                                                class="fa fa-search" aria-hidden="true"></i></button>
                                    </span>
                                </div>
                                <input type="text" class="form-control input-sm" style="width: 50em"
                                    ng-model="buscador.$" placeholder="Buscar..." /><br />
                                <div class="btn-group" role="group" aria-label="..."
                                    style="padding-top: 0.75em; width: 100%; margin: 0 auto !important;">
                                    <!--
                                    <button type="button" class="btn btn-default btn-sm tipo" ng-repeat="ep in lstestatuspresup" ng-click="getLstPresupuestos(ep.id)">
                                        {{ep.descestatuspresup}}
                                    </button>
                                    -->
                                    <button type="button" class="btn btn-default btn-sm tipo"
                                        ng-click="getLstPresupuestos('1,2,3')">
                                        En proceso
                                    </button>
                                    <button type="button" class="btn btn-default btn-sm tipo"
                                        ng-click="getLstPresupuestos('4,5')">
                                        Terminados
                                    </button>
                                    <button type="button" class="btn btn-default btn-sm tipo"
                                        ng-click="getLstPresupuestos('6')">
                                        Anulados
                                    </button>
                                    <button type="button" class="btn btn-default btn-sm tipo"
                                        ng-click="getLstPresupuestos(null)">
                                        Todos
                                    </button>
                                    <button type="button" class="btn btn-default btn-sm tipo" ng-click="groupPrint(true)">
                                        Impresi&oacute;n
                                    </button>
                                    <button type="button" class="btn btn-default btn-sm tipo" ng-click="groupPrint(false)">
                                        Impresi&oacute;n (Anterior)
                                    </button>
                                    
                                </div>
                            </form>
                        </caption>
                        <thead>
                            <tr>
                                <th style="text-align: center">No.</th>
                                <th style="text-align: center">Solicitud</th>
                                <th style="text-align: center">Proyecto</th>
                                <th style="text-align: center">Empresa</th>
                                <th style="text-align: center">Tipo</th>
                                <th style="text-align: center">Concepto</th>
                                <th style="text-align: center">Total</th>
                                <!--<th style="text-align: right">Gastado</th>-->
                                <th>&nbsp;</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-show="loadingPresupuestos">
                                <td colspan="9">
                                    <div style="width: 100%; height: 50px;">
                                        <span style="font-family: Arial; font-weight: bold; font-size: 16pt;">
                                            Cargando informaci&oacute;n. Por favor espere...
                                            <img src="img/generando.gif" alt="Cargando informaci&oacute;n..." width="25"
                                                height="25" />
                                        </span>
                                    </div>
                                </td>
                            </tr>
                            <tr ng-repeat="p in lstpresupuestos | filter:buscador" ng-click="getPresupuesto(p.id)"
                                ng-class="{'bld': +p.tipo!= 1, 'presPendiente': +p.idestatuspresupuesto == 2 && +p.tipo == 1, 'presAprobado': +p.idestatuspresupuesto == 3 && +p.tipo == 1}">
                                <td style="white-space: nowrap; text-align: center;">{{p.tipostr}}-{{p.id}}</td>
                                <td style="text-align: center">{{p.fechasolicitud | date:'dd/MM/yyyy'}}</td>
                                <td style="text-align: center">{{p.proyecto | shortenStr:17}}</td>
                                <td style="text-align: center">{{p.abreviaempre}}</td>
                                <td style="text-align: center">{{p.tipogasto | shortenStr:10}}</td>
                                <td>
                                    <p style="white-space: normal; text-align: center;">{{p.notas | shortenStr:50}}</p>
                                </td>
                                <td style="text-align: center;  ">
                                    {{p.simbolo}}&nbsp;{{p.total | number:2}}</td>
                                <td style="white-space: nowrap !important;">
                                    <div class="btn-group" role="group" aria-label="..."
                                        style="white-space: nowrap !important;">
                                        <!--<button type="button" class="btn btn-info btn-sm tipo"
                                            ng-click="printPrespuesto(p.id, 0)" data-toggle="tooltip"
                                            data-placement="auto" title="Imprimir sin avances">
                                            R.
                                        </button>
                                        <button type="button" class="btn btn-info btn-sm tipo"
                                        ng-click="printPrespuestoNue(p.id)" data-toggle="tooltip"
                                        data-placement="auto" title="Imprimir sin avances">
                                        N.
                                        </button>-->
                                        <button type="button" class="btn btn-info btn-sm tipo"
                                            ng-click="printPrespuesto(p.id, 1)" data-toggle="tooltip"
                                            data-placement="auto" title="Imprimir con avances">
                                            D.
                                        </button>
                                        <button type="button" class="btn btn-primary btn-sm tipo"
                                        ng-click="printPrespuestoNueD(p.id)" data-toggle="tooltip"
                                        data-placement="auto" title="Imprimir con avances nuevo">
                                        N.
                                        </button>
                                        <button type="button" class="btn btn-info btn-sm tipo"
                                            ng-click="printOt(p.idot)" data-toggle="tooltip" data-placement="auto"
                                            title="Imprimir detalle" ng-show="+p.tipo === 1">
                                            <span class="glyphicon glyphicon-print"></span>
                                        </button>
                                        <button type="button" class="btn btn-primary btn-sm tipo"
                                        ng-click="printOtNue(p.idot)" data-toggle="tooltip" data-placement="auto"
                                        title="Imprimir detalle" ng-show="+p.tipo === 1">
                                        <span class="glyphicon glyphicon-print"></span>
                                    </button>
                                        <button type="button" class="btn btn-info btn-sm tipo" ng-click="enviar(p)"
                                            ng-show="+p.idestatuspresupuesto == 1 && +p.tipo == 1" data-toggle="tooltip"
                                            data-placement="auto" title="Enviar presupuesto a aprobación...">
                                            <span class="glyphicon glyphicon-share-alt"></span>
                                        </button>
                                        <button type="button" class="btn btn-warning btn-sm tipo"
                                            ng-click="terminaPresupuesto(p)"
                                            ng-show="+p.idestatuspresupuesto == 3 && permiso.m && +p.tipo == 1"
                                            data-toggle="tooltip" data-placement="auto" title="Terminar presupuesto">
                                            <span class="glyphicon glyphicon-folder-close"></span>
                                        </button>
                                        <button type="button" class="btn btn-warning btn-sm tipo"
                                            ng-click="reabrirPresupuesto(p)"
                                            ng-show="+p.idestatuspresupuesto == 5 && permiso.m && +p.tipo == 1"
                                            data-toggle="tooltip" data-placement="auto" title="Re-abrir presupuesto">
                                            <span class="glyphicon glyphicon-folder-open"></span>
                                        </button>
                                        <button type="button" class="btn btn-danger btn-sm tipo"
                                            ng-click="anulaPresupuesto(p)"
                                            ng-show="+p.idestatuspresupuesto < 4 && permiso.m && +p.tipo == 1"
                                            data-toggle="tooltip" data-placement="auto" title="Anular">
                                            <span class="glyphicon glyphicon-remove-circle"></span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="divFrmPresup" class="tab-pane fade">
            <div class="panel panel-info">
                <div class="panel-heading">
                    &Oacute;rden de trabajo
                    {{+presupuesto.tipo == 1 ? 'simple' : (+presupuesto.tipo == 2 ? 'múltiple' : '')}}&nbsp;
                    <span class="label label-primary label-pill">{{lbl.presupuesto}}</span>&nbsp;
                    <span class="label label-warning label-pill"
                        ng-show="+presupuesto.idestatuspresupuesto == 2">Esperando aprobaci&oacute;n...</span>&nbsp;
                    <span class="label label-success label-pill"
                        ng-show="+presupuesto.idestatuspresupuesto == 3">Presupuesto aprobado</span>&nbsp;
                    <span class="label label-danger label-pill"
                        ng-show="+presupuesto.idestatuspresupuesto == 4">Presupuesto denegado</span>
                    <span class="label label-danger label-pill"
                        ng-show="+presupuesto.idestatuspresupuesto == 6">Presupuesto anulado</span>
                </div>
                <div class="panel-body">
                    <form name="frmPresup" id="frmPresup" ng-submit="frmPresup.$valid && addPresupuesto(presupuesto)"
                        novalidate>
                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group">
                                    <label for="lblNoPresup">No.</label>
                                    <span name="lblNoPresup" id="lblNoPresup" class="form-control"
                                        ng-disabled="sl.presupuesto">{{presupuesto.id}}</span>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selTipo.$invalid && !frmPresup.selTipo.$pristine}">
                                    <label for="selTipo">Tipo:</label>
                                    <select name="selTipo" id="selTipo" class="form-control" ng-model="presupuesto.tipo"
                                        ng-disabled="sl.presupuesto" required>
                                        <option value="1">Simple</option>
                                        <option value="2">M&uacute;ltiple</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.txtFecSol.$invalid && !frmPresup.txtFecSol.$pristine}">
                                    <label for="txtFecSol">Fecha de solicitud:</label>
                                    <input name="txtFecSol" id="txtFecSol" type="date" class="form-control"
                                        ng-model="presupuesto.fechasolicitud" required ng-disabled="sl.presupuesto" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selProy.$invalid && !frmPresup.selProy.$pristine}">
                                    <label>Proyecto:</label>
                                    <ui-select ng-model="presupuesto.proyecto" title="Seleccione un proyecto..."
                                        theme="bootstrap" autofocus="true" append-to-body="true"
                                        on-select="setEmpresa($item)" ng-disabled="sl.presupuesto">
                                        <ui-select-match placeholder="Buscar proyecto..." allow-clear="false">
                                            <span ng-bind="$select.selected.nomproyecto"></span>
                                        </ui-select-match>
                                        <ui-select-choices
                                            repeat="item.id as item in proyectos | filter:$select.search">
                                            <div ng-bind-html="item.nomproyecto | highlight: $select.search"></div>
                                            <small>
                                                <strong>Empresa:</strong>&nbsp;<span
                                                    ng-bind-html="item.empresa | highlight: $select.search"></span><br />
                                                <strong>Tipo:</strong>&nbsp;<span
                                                    ng-bind-html="item.tipoproyecto | highlight: $select.search"></span>
                                            </small>
                                        </ui-select-choices>
                                        <ui-select-no-choice>
                                            No hay resultados...
                                        </ui-select-no-choice>
                                    </ui-select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selEmp.$invalid && !frmPresup.selEmp.$pristine}">
                                    <label>Empresa:</label>
                                    <ui-select ng-model="presupuesto.empresa" title="Seleccione una empresa..."
                                        theme="bootstrap" autofocus="true" append-to-body="true"
                                        ng-disabled="sl.presupuesto">
                                        <ui-select-match placeholder="Buscar empresa..." allow-clear="false">
                                            <span ng-bind="$select.selected.nomempresa"></span>
                                        </ui-select-match>
                                        <ui-select-choices repeat="item.id as item in empresas | filter:$select.search">
                                            <div ng-bind-html="item.nomempresa | highlight: $select.search"></div>
                                        </ui-select-choices>
                                        <ui-select-no-choice>
                                            No hay resultados...
                                        </ui-select-no-choice>
                                    </ui-select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selTipoGasto.$invalid && !frmPresup.selTipoGasto.$pristine}">
                                    <label for="selTipoGasto">Tipo de gasto:</label>
                                    <select name="selTipoGasto" id="selTipoGasto" class="form-control"
                                        ng-model="presupuesto.idtipogasto"
                                        ng-options="obj.id as obj.desctipogast for obj in tiposgasto" required
                                        ng-disabled="sl.presupuesto"
                                        ng-change="loadSubtTiposGasto(presupuesto.idtipogasto)">
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selMoneda.$invalid && !frmPresup.selMoneda.$pristine}">
                                    <label for="selMoneda">Moneda:</label>
                                    <select name="selMoneda" id="selMoneda" class="form-control"
                                        ng-model="presupuesto.idmoneda"
                                        ng-options="obj.id as obj.simbolo for obj in monedas" required
                                        ng-disabled="sl.presupuesto">
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.txtTotal.$invalid && !frmPresup.txtTotal.$pristine}">
                                    <label for="txtTotal">Total:</label>
                                    <input name="txtTotal" id="txtTotal" class="form-control" type="text"
                                        ng-model="presupuesto.total" fcsa-number="{maxDecimals:2}" ng-disabled="true" />
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="form-group">
                                    <label for="txtDescrip">Descripci&oacute;n:</label>
                                    <textarea name="txtDescrip" id="txtDescrip" class="form-control" style="width:100%"
                                        ng-model="presupuesto.notas" rows="3" ng-disabled="sl.presupuesto">
                                    </textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row" ng-show="+presupuesto.tipo == 1">
                            <div class="col-md-3">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selProveedorPresup.$invalid && !frmOT.selProveedorPresup.$pristine}">
                                    <label>Proveedor/Beneficiario:</label>
                                    <ui-select name="selProveedorPresup" ng-model="presupuesto.idproveedor"
                                        title="Seleccione un proveedor/beneficiario..." theme="bootstrap"
                                        autofocus="true" append-to-body="true" ng-required="+presupuesto.tipo == 1"
                                        ng-disabled="sl.presupuesto" on-select="setOrigenProv($item, $model)">
                                        <ui-select-match placeholder="Buscar proveedor/beneficiario..."
                                            allow-clear="false">
                                            <span ng-bind="$select.selected.beneficiario"></span>
                                        </ui-select-match>
                                        <ui-select-choices
                                            repeat="item.id as item in proveedores | filter:$select.search"
                                            group-by="'grupo'">
                                            <div ng-bind-html="item.beneficiario | highlight: $select.search"></div>
                                            <!--
                                            <small>
                                                <strong>N.I.T.:</strong>&nbsp;<span ng-bind-html="item.nit | highlight: $select.search" ></span>
                                            </small>
                                            -->
                                        </ui-select-choices>
                                        <ui-select-no-choice>
                                            No hay resultados...
                                        </ui-select-no-choice>
                                    </ui-select>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.selSubtTipoGastoPresup.$invalid && !frmPresup.selSubtTipoGastoPresup.$pristine}">
                                    <label>Sub-tipo de gasto:</label>
                                    <ui-select name="selSubtTipoGastoPresup" ng-model="presupuesto.idsubtipogasto"
                                        title="Seleccione un sub-tipo de gasto..." theme="bootstrap" autofocus="false"
                                        append-to-body="true" ng-required="+presupuesto.tipo == 1"
                                        ng-disabled="sl.presupuesto">
                                        <ui-select-match placeholder="Buscar sub-tipo de gasto..." allow-clear="false">
                                            <span ng-bind="$select.selected.descripcion"></span>
                                        </ui-select-match>
                                        <ui-select-choices
                                            repeat="item.id as item in subtiposgasto | filter:$select.search">
                                            <div ng-bind-html="item.descripcion | highlight: $select.search"></div>
                                        </ui-select-choices>
                                        <ui-select-no-choice>
                                            No hay resultados...
                                        </ui-select-no-choice>
                                    </ui-select>
                                </div>
                            </div>
                            <div class="col-md-1">
                                <div class="form-group">
                                    <label for="chkIVAPresup">I.V.A.</label>
                                    <input name="chkIVAPresup" id="chkIVAPresup" type="checkbox" class="form-control"
                                        ng-model="presupuesto.coniva" ng-true-value="1" ng-false-value="0"
                                        ng-disabled="sl.presupuesto" />
                                </div>
                            </div>
                            <!--<div class="col-md-1">
                                <div class="form-group">
                                    <label for="chkContado">Contado:</label>
                                    <input name="chkContado" id="chkContado" type="checkbox" class="form-control" ng-model="presupuesto.escontado" 
                                    ng-true-value="'1'" ng-false-value="'0'" ng-disabled="sl.presupuesto"/>
                                </div>
                            </div>-->
                            <div class="col-md-3">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.txtMontoPresup.$invalid && !frmPresup.txtMontoPresup.$pristine}">
                                    <label for="txtMontoPresup">Valor:</label>
                                    <input name="txtMontoPresup" id="txtMontoPresup" type="text" class="form-control"
                                        ng-model="presupuesto.monto" fcsa-number="{maxDecimals:2}"
                                        ng-required="+presupuesto.tipo == 1" ng-disabled="sl.presupuesto" />
                                </div>
                            </div>
                            <div class="col-md-2">
                                <div class="form-group"
                                    ng-class="{'has-error':frmPresup.txtTCPresup.$invalid && !frmPresup.txtTCPresup.$pristine}">
                                    <label for="txtTCPresup">TC:</label>
                                    <div class="input-group">
                                    <input name="txtTCPresup" id="txtTCPresup" type="text" class="form-control"
                                        ng-model="presupuesto.tipocambio" fcsa-number="{maxDecimals:5}"
                                        ng-required="+presupuesto.tipo == 1" ng-disabled="sl.presupuesto" />
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-primary" ng-click="presupuesto.tipocambio = tipocambiogt;"
                                            ng-disabled="sl.presupuesto">
                                                <span>TC</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <form-buttons vis="grpBtnPresupuesto" btn-dis="frmPresup.$invalid" obj="presupuesto"
                            uf="updPresupuesto(presupuesto)" df="delPresupuesto(presupuesto)" nf="nuevoPresupuesto()"
                            cf="cancelEditPresup()" ef="startEditPresup()" pf="imprimirPresup()"
                            ng-hide="(+presupuesto.idestatuspresupuesto == 6 || +presupuesto.idestatuspresupuesto == 5) || !permiso.m">
                        </form-buttons>
                        <button type="button" class="btn btn-info" ng-click="verDetPagos(presupuesto, true)"
                            ng-show="+presupuesto.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo == 1"
                            data-toggle="tooltip" data-placement="auto" title="Ver detalle de pagos...">
                            <i class="fa fa-money fa-lg" aria-hidden="true"></i>
                        </button>
                        <button type="button" class="btn btn-info" ng-click="printOt(presupuesto.id, true)"
                            ng-show="+presupuesto.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo == 1"
                            data-toggle="tooltip" data-placement="auto" title="Imprimir...">
                            <i class="fa fa-print fa-lg" aria-hidden="true"></i>
                        </button>
                        <button type="button" class="btn btn-primary" ng-click="printOtNue(presupuesto.id, true)"
                        ng-show="+presupuesto.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo == 1"
                        data-toggle="tooltip" data-placement="auto" title="Imprimir...">
                        <i class="fa fa-print fa-lg" aria-hidden="true"></i>
                    </button>
                        <button type="button" class="btn btn-info" ng-click="adherirAOTM(presupuesto, true)"
                            ng-show="+presupuesto.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo == 1"
                            data-toggle="tooltip" data-placement="auto" title="Adherir a OTM existente...">
                            <span class="glyphicon glyphicon-refresh"></span>
                        </button>
                        <button type="button" class="btn btn-primary" ng-click="aumentaExcedente(presupuesto)"
                            ng-show="+presupuesto.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo == 1"
                            data-toggle="tooltip" data-placement="auto" title="Cambiar porcentaje de excedente...">
                            <span class="glyphicon glyphicon-arrow-up"></span>
                        </button>
                        <button type="button" class="btn btn-warning" ng-click="terminaPresupuesto(presupuesto)"
                            ng-show="+presupuesto.idestatuspresupuesto == 3 && permiso.m" data-toggle="tooltip"
                            data-placement="auto" title="Terminar presupuesto">
                            <span class="glyphicon glyphicon-folder-close"></span>
                        </button>
                        <button type="button" class="btn btn-warning" ng-click="reabrirPresupuesto(presupuesto)"
                            ng-show="+presupuesto.idestatuspresupuesto == 5 && permiso.m" data-toggle="tooltip"
                            data-placement="auto" title="Re-abrir presupuesto">
                            <span class="glyphicon glyphicon-folder-open"></span>
                        </button>
                        <button type="button" class="btn btn-info" ng-click="enviar(presupuesto)"
                        ng-show="+presupuesto.idestatuspresupuesto === 1 && +presupuesto.tipo === 1" data-toggle="tooltip"
                        data-placement="auto" title="Enviar presupuesto a aprobación..." ng-disabled="(!sl.presupuesto)  || +presupuesto.idestatuspresupuesto == 2" >
                        <span class="glyphicon glyphicon-share-alt"></span>
                    </button>
                        <button type="button" class="btn btn-danger" ng-click="anulaPresupuesto(presupuesto)"
                        ng-hide="(+presupuesto.idestatuspresupuesto == 6 || +presupuesto.idestatuspresupuesto == 5) || !permiso.m" data-toggle="tooltip"
                            data-placement="auto" title="Anular">
                            <span class="glyphicon glyphicon-remove-circle"></span>
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <div id="divDetPresup" class="tab-pane fade">
            <div class="panel panel-info">
                <div class="panel-heading">DETALLE</div>
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-12 nopadding">
                            <div class="well well-sm">
                                <h3>&Oacute;RDEN DE TRABAJO {{+presupuesto.tipo == 1 ? 'SIMPLE' : 'MÚLTIPLE'}}: {{lbl.id}}</h3>
                                <ul>
                                    <!--<li><h3>{{lbl.id}}</h3></li>-->
                                    <li style="color: black; font-size: 120%;"><p>{{lbl.proyecto}}</p></li>
                                    <li style="color: black; font-size: 120%;"><p>{{lbl.empresa}}</p></li>
                                    <li style="color: black; font-size: 120%;"><p>{{lbl.notas}}</p></li>
                                    <li style="color: black; font-size: 120%;"><p>{{lbl.tipgasto}}</p></li>
                                    <li style="color: black; font-size: 120%;"><p>{{lbl.montopres}}</p></li>
                                    <li style="color: black; font-size: 120%;"><p>{{lbl.montogas}}</p></li>
                                    <li style="color: black; font-size: 120%;"><p style="float: left;">{{lbl.avance}}</p>
                                        <button ng-hide="+presupuesto.tipo == 1" style="float: right;" type="button" class="btn btn-primary btn-sm tipo"
                                        ng-click="printPrespuestoNueD(lbl.id)" data-toggle="tooltip"
                                        data-placement="auto" title="Imprimir con avances nuevo">
                                        N.
                                        </button>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="row" ng-show="+presupuesto.tipo == 2">
                        <div class="col-md-12 nopadding" style="text-align: right">
                            <button type="button" class="btn btn-info btn-xs" ng-click="showForm.ot = !showForm.ot"
                                ng-hide="showForm.ot" aria-label="Toggle ngHide">
                                <span class="glyphicon glyphicon-chevron-down"></span>
                            </button>
                            <button type="button" class="btn btn-info btn-xs" ng-click="showForm.ot = !showForm.ot"
                                ng-show="showForm.ot" aria-label="Toggle ngHide">
                                <span class="glyphicon glyphicon-chevron-up"></span>
                            </button>
                        </div>
                    </div>
                    <form name="frmOT" id="frmOT" ng-submit="frmOT.$valid && addOt(ot)" class="check-element animate-show" ng-show="showForm.ot && +presupuesto.tipo == 2" novalidate>
                        <div class="row">
                            <div class="col-md-1 nopadding">
                                <div class="form-group">
                                    <label for="lblNoOt">No.</label>
                                    <span name="lblNoOt" id="lblNoOt" class="form-control"
                                        ng-disabled="true">{{ot.correlativo}}</span>
                                </div>
                            </div>
                            <div class="col-md-3 nopadding">
                                <div class="form-group"
                                    ng-class="{'has-error':frmOT.selProveedor.$invalid && !frmOT.selProveedor.$pristine}">
                                    <label>Proveedor/Beneficiario:</label>
                                    <ui-select name="selProveedorPresupOt" ng-model="ot.idproveedor"
                                        title="Seleccione un proveedor/beneficiario..." theme="bootstrap"
                                        autofocus="true" append-to-body="true" ng-disabled="sl.ot"
                                        on-select="setOrigenProvOt($item, $model)">
                                        <ui-select-match placeholder="Buscar proveedor/beneficiario..."
                                            allow-clear="false">
                                            <span ng-bind="$select.selected.beneficiario"></span>
                                        </ui-select-match>
                                        <ui-select-choices
                                            repeat="item.id as item in proveedores | filter:$select.search"
                                            group-by="'grupo'">
                                            <div ng-bind-html="item.beneficiario | highlight: $select.search"></div>
                                        </ui-select-choices>
                                        <ui-select-no-choice>
                                            No hay resultados...
                                        </ui-select-no-choice>
                                    </ui-select>
                                </div>
                            </div>
                            <div class="col-md-3 nopadding">
                                <div class="form-group"
                                    ng-class="{'has-error':frmOT.selSubtTipoGasto.$invalid && !frmOT.selSubtTipoGasto.$pristine}">
                                    <label>Sub-tipo de gasto:</label>
                                    <ui-select ng-model="ot.idsubtipogasto" title="Seleccione un sub-tipo de gasto..."
                                        theme="bootstrap" autofocus="false" append-to-body="true" ng-disabled="sl.ot">
                                        <ui-select-match placeholder="Buscar sub-tipo de gasto..." allow-clear="false">
                                            <span ng-bind="$select.selected.descripcion"></span>
                                        </ui-select-match>
                                        <ui-select-choices
                                            repeat="item.id as item in subtiposgasto | filter:$select.search">
                                            <div ng-bind-html="item.descripcion | highlight: $select.search"></div>
                                        </ui-select-choices>
                                        <ui-select-no-choice>
                                            No hay resultados...
                                        </ui-select-no-choice>
                                    </ui-select>
                                </div>
                            </div>
                            <div class="col-md-1 nopadding">
                                <div class="form-group">
                                    <label for="chkIVA">I.V.A.</label>
                                    <input name="chkIVA" id="chkIVA" type="checkbox" class="form-control"
                                        ng-model="ot.coniva" ng-true-value="1" ng-false-value="0" ng-disabled="sl.ot" />
                                </div>
                            </div>
                            <div class="col-md-1 nopadding">
                                <div class="form-group"
                                    ng-class="{'has-error':frmOT.selMonedaOT.$invalid && !frmOT.selMonedaOT.$pristine}">
                                    <label for="selMonedaOT">Moneda:</label>
                                    <select name="selMonedaOT" id="selMonedaOT" class="form-control"
                                        ng-model="ot.idmoneda" ng-options="obj.id as obj.simbolo for obj in monedas"
                                        required ng-disabled="sl.ot">
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2 nopadding">
                                <div class="form-group"
                                    ng-class="{'has-error':frmOT.txtMonto.$invalid && !frmOT.txtMonto.$pristine}">
                                    <label for="txtMonto">Valor:</label>
                                    <input name="txtMonto" id="txtMonto" type="text" class="form-control"
                                        ng-model="ot.monto" fcsa-number="{maxDecimals:2}" required
                                        ng-disabled="sl.ot" />
                                </div>
                            </div>
                            <div class="col-md-1 nopadding">
                                <div class="form-group"
                                    ng-class="{'has-error':frmOT.txtTC.$invalid && !frmOT.txtTC.$pristine}">
                                    <label for="txtTC">TC:</label>
                                    <div class="input-group">
                                    <input name="txtTC" id="txtTC" type="text" class="form-control"
                                        ng-model="ot.tipocambio" fcsa-number="{maxDecimals:5}" required
                                        ng-disabled="sl.ot" />
                                        <div class="input-group-btn">
                                            <button type="button" class="btn btn-primary" ng-click="ot.tipocambio = tipocambiogt;"
                                            ng-disabled="sl.ot">
                                                <span>TC</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-9 nopadding">
                                <div class="form-group"
                                    ng-class="{'has-error':frmOT.txtNotasOt.$invalid && !frmOT.txtNotasOt.$pristine}">
                                    <label for="txtNotasOt">Notas:</label>
                                    <textarea name="txtNotasOt" id="txtNotasOt" type="text" class="form-control"
                                        ng-model="ot.notas" required ng-disabled="sl.ot" rows="3"></textarea>
                                </div>
                            </div>
                            <!--<div class="col-md-1">
                                <div class="form-group">
                                    <label for="chkContadoOt">Contado:</label>
                                    <input name="chkContadoOt" id="chkContadoOt" type="checkbox" class="form-control" ng-model="ot.escontado" 
                                    ng-true-value="1" ng-false-value="0" ng-disabled="sl.ot"/>
                                </div>
                            </div>-->
                        </div>
                        <form-buttons vis="grpBtnOt" btn-dis="frmOT.$invalid" obj="ot" uf="updOt(ot)" df="delOt(ot)"
                            nf="nuevaOt()" cf="cancelEditOt()" ef="startEditOt()" pf="imprimirOt()"
                            ng-hide="!permiso.m || [5, 6].indexOf(+ot.idestatuspresupuesto) > -1">
                        </form-buttons>
                    </form>
                    <hr />
                    <table class="table table-hover table-condensed">
                        <caption>
                            <input name="srchTxt" id="srchTxt" type="text" class="form-control input-sm"
                                style="width: 100%" ng-model="lookFor.$" placeholder="Buscar..." />
                        </caption>
                        <thead>
                            <tr>
                                <th style="text-align: center">No.</th>
                                <th style="text-align: center">Proveedor/Beneficiario</th>
                                <th style="text-align: center">Sub-tipo de gasto</th>
                                <th style="text-align: center;">Avance</th>
                                <!-- <th style="text-align: center">Incluye I.V.A.</th>
                                <th style="text-align: center">Monto</th>
                                <th style="text-align: center">TC</th> -->
                                <th style="text-align: center">Detalle de pagos</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="o in lstot | filter:lookFor" ng-click="getOt(o.id)"
                                ng-class="{'presPendiente': +o.idestatuspresupuesto == 2, 'presAprobado': +o.idestatuspresupuesto == 3}">
                                <td style="text-align: center">{{o.idpresupuesto}}-{{o.correlativo}}</td>
                                <td style="text-align: center">{{o.proveedor}}</td>
                                <td style="text-align: center">{{o.subtipogasto}}</td>
                                <td style="text-align: center;">{{o.avanceot}}</td>
                                <!-- <td style="text-align: center">{{o.coniva === 1 ? 'Sí' : ''}}</td>
                                <td style="text-align: center">{{o.moneda}}{{o.monto | number:2}}</td>
                                <td style="text-align: center">{{o.tipocambio | number:5}}</td> -->
                                <td style="text-align: center;">
                                    <div class="btn-group" role="group" aria-label="..."
                                        style="padding-top: 0.75em; width: 100%; margin: 0 auto !important; text-align: center">
                                        <button type="button" class="btn btn-info btn-sm tipo"
                                            ng-click="enviar(o, +o.idpresupuesto, +o.correlativo)"
                                            ng-show="+o.idestatuspresupuesto == 1 && +presupuesto.tipo != 1"
                                            data-toggle="tooltip" data-placement="auto"
                                            title="Enviar ot a aprobación...">
                                            <span class="glyphicon glyphicon-share-alt"></span>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-info" ng-click="verDetPagos(o)"
                                            data-toggle="tooltip" data-placement="auto" title="Ver detalle de pagos...">
                                            <i class="fa fa-money fa-lg" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-info" ng-click="printOt(o.id)"
                                            data-toggle="tooltip" data-placement="auto" title="Imprimir...">
                                            <i class="fa fa-print fa-lg" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-primary" ng-click="printOtNue(o.id)"
                                        data-toggle="tooltip" data-placement="auto" title="Imprimir...">
                                        <i class="fa fa-print fa-lg" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-info" ng-click="ampliar(o)"
                                            ng-show="+o.idestatuspresupuesto == 3 && permiso.m" data-toggle="tooltip"
                                            data-placement="auto" title="Ampliar presupuesto...">
                                            <i class="fas fa-plane-departure"></i>
                                        </button>
                                        <button type="button" class="btn btn-sm btn-primary"
                                            ng-click="aumentaExcedente(o, true)"
                                            ng-show="+o.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo !== 1"
                                            data-toggle="tooltip" data-placement="auto"
                                            title="Cambiar porcentaje de excedente...">
                                            <span class="glyphicon glyphicon-arrow-up"></span>
                                        </button>
                                        <button type="button" class="btn btn-warning btn-sm tipo"
                                            ng-click="terminaPresupuesto(o, +o.idpresupuesto, +o.correlativo)"
                                            ng-show="+o.idestatuspresupuesto == 3 && permiso.m && +presupuesto.tipo != 1"
                                            data-toggle="tooltip" data-placement="auto" title="Terminar presupuesto">
                                            <span class="glyphicon glyphicon-folder-close"></span>
                                        </button>
                                        <button type="button" class="btn btn-warning btn-sm tipo"
                                            ng-click="reabrirPresupuesto(o, +o.idpresupuesto, +o.correlativo)"
                                            ng-show="+o.idestatuspresupuesto == 5 && permiso.m && +presupuesto.tipo != 1"
                                            data-toggle="tooltip" data-placement="auto" title="Re-abrir presupuesto">
                                            <span class="glyphicon glyphicon-folder-open"></span>
                                        </button>
                                        <button type="button" class="btn btn-danger btn-sm tipo"
                                            ng-click="anulaPresupuesto(o, +o.idpresupuesto, +o.correlativo)"
                                            ng-show="+o.idestatuspresupuesto < 4 && permiso.m && +presupuesto.tipo != 1"
                                            data-toggle="tooltip" data-placement="auto" title="Anular">
                                            <span class="glyphicon glyphicon-remove-circle"></span>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="divAdjuntos" class="tab-pane fade">
            <div class="panel panel-info">
                <div class="panel-heading">Archivos adjuntos</div>
                <div class="panel-body">
                    <form name="frmOTAdjunto" id="frmOTAdjunto" ng-submit="frmOTAdjunto.$valid && addOTAdjunto()" class="check-element animate-show" ng-show="+presupuesto.id > 0" novalidate>
                        <div class="row">
                            <div class="col-md-4">
                                <div class="form-group" ng-class="{'has-error':frmOTAdjunto.txtNomAjunto.$invalid && !frmOTAdjunto.txtNomAjunto.$pristine}">
                                    <label for="txtNomAjunto">Nombre:</label>
                                    <input name="txtNomAjunto" id="txtNomAjunto" type="text" class="form-control" ng-model="otAdjunto.nomadjunto" placeholder="Nombre del adjunto" required/>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <button name="adjuntar_btn" id="adjuntar_btn" type="button" class="btn btn-info"
                                        ngf-select ng-model="file" name="file" ngf-multiple="false"
                                        ngf-pattern="'image/*,application/pdf,.xls,.xlsx,.doc,.docx,.txt'"
                                        ngf-accept="'image/*,application/pdf,.xls,.xlsx,.doc,.docx,.txt'"
                                        ngf-max-size="200MB" style="width: 100%">
                                    {{(file.name | textCleaner) || 'Seleccionar documento para subir'}}&nbsp;<span class="glyphicon glyphicon-upload"></span>
                                </button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-1">
                                <button type="submit" class="btn btn-info" ng-disabled="frmOTAdjunto.$invalid || file == null || file == undefined">
                                    <span class="glyphicon glyphicon-floppy-save"></span>
                                </button>
                            </div>
                            <div class="col-md-2">
                                <div>
                                    <round-progress max="100" current="progressPercentage" color="#4CAF50" bgcolor="#eaeaea" radius="25" stroke="10"
                                                    semi="true" rounded="true" clockwise="true" responsive="false" duration="800"
                                                    animation="easeInOutQuart" animation-delay="0">
                                    </round-progress>
                                </div>
                            </div>
                        </div>
                    </form>
                    <hr/>
                    <table class="table table-responsive table-hover table-condensed">
                        <thead>
                        <tr>
                            <th>Nombre</th>
                            <th>&nbsp;</th>
                            <th>&nbsp;</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="ot_adjunto in lstotadjuntos">
                            <td>{{ot_adjunto.nomadjunto}}</td>                            
                            <td>
                                <a class="btn btn-info" href="{{ot_adjunto.ubicacion}}" target="_blank">
                                    <span class="glyphicon glyphicon-download"></span>
                                </a>
                            </td>
                            <td style="white-space: nowrap">
                                <button type="button" class="btn btn-danger" ng-click="delOTAdjunto(ot_adjunto.id)">
                                    <span class="glyphicon glyphicon-trash"></span>
                                </button>
                            </td>
                        </tr>
                        </tbody>
                    </table>                    
                </div>
            </div>
        </div>
        <!--<div id="divDocumentos" class="tab-pane fade">
            <div id="divNgInclude" ng-include="ngIncludeUrl"></div>
        </div>-->
        <div id="divTranBan" class="tab-pane fade">
            <div id="divNgIncludeTB" ng-include="ngIncludeUrlTB"></div>
        </div>
        <div id="divGenPagos" class="tab-pane fade">
            <div id="divNgIncludeGenPagosOT" ng-include="urlGenCheques"></div>
        </div>
    </div>
    <script type="text/ng-template" id="modalDetPagosOt.html">
        <div class="modal-header">
            <h3 class="modal-title">Formas de pago de OT No. {{ot.idpresupuesto}}-{{ot.correlativo}}</h3>
            <h4>
                Proveedor/beneficiario: {{ot.proveedor}}<br/>
                Sub-tipo de gasto: {{ot.subtipogasto}}<br/>
                Total de presupuesto: {{ot.moneda}}&nbsp;{{ot.total | number:2}}<br/>
                Monto de OT: {{ot.moneda}}&nbsp;{{ot.monto | number:2}}
            </h4>
        </div>
        <div class="modal-body" style="height: 300px; overflow-y: auto">
            <form name="frmDetPago" id="frmDetPago" ng-submit="frmDetPago.$valid && addFormaPago(fpago)" novalidate>
                <div class="row">
                    <!--
                    <div class="col-md-3 nopadding">
                        <div class="form-group">
                            <label for="txtPorcentaje">Porcentaje (%):</label>
                            <input name="txtPorcentaje" id="txtPorcentaje" type="number" class="form-control input-sm" ng-model="fpago.porcentaje" step="0.0001" min="0.0001" ng-blur="calcValor()" required/>
                        </div>
                    </div>
                    -->
                    <div class="col-md-3 nopadding">
                        <div class="form-group">
                            <label for="selMonedaFP">Moneda:</label>
                            <select name="selMonedaFP" id="selMonedaFP" class="form-control input-sm" ng-model="fpago.idmoneda"
                                    ng-options="obj.id as obj.simbolo for obj in monedas" required>
                            </select>
                        </div>
                    </div>
                    <div class="col-md-3 nopadding">
                        <div class="form-group">
                            <label for="txtMontoDetP">Monto:</label>
                            <input name="txtMontoDetP" id="txtMontoDetP" type="number" class="form-control input-sm" ng-model="fpago.monto" step="0.01" min="0.01" ng-blur="calcPorcentaje()" required/>
                        </div>
                    </div>
                    <div class="col-md-3 nopadding">
                        <div class="form-group">
                            <label for="chkQuitarISR">Quitar I.S.R.:</label>
                            <input name="chkQuitarISR" id="chkQuitarISR" type="checkbox" class="form-control input-sm" ng-model="fpago.quitarisr" ng-true-value="1" ng-false-value="0"/>
                        </div>
                    </div>
                    <div class="col-md-3 nopadding">
                        <div class="form-group">
                            <label for="txtMontoDetISR">Monto calc. I.S.R.:</label>
                            <input name="txtMontoDetISR" id="txtMontoDetISR" type="number" class="form-control input-sm" ng-model="fpago.isr" min="0.00" step="0.01" ng-disabled="+fpago.quitarisr == 0" ng-required="+fpago.quitarisr == 1"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 nopadding">
                        <div class="form-group">
                            <label for="txtNotas">Notas:</label>
                            <textarea name="txtNotas" id="txtNotas" class="form-control input-sm" rows="1" maxlength="1000" ng-model="fpago.notas" placeholder="Notas para el pago..." style="width: 100%"></textarea>
                        </div>
                    </div>
                </div>
                <div class="btn-group" role="group" aria-label="...">
                    <button type="submit" class="btn btn-info" ng-disabled="frmDetPago.$invalid" 
                        ng-show="sumporcentaje < porexcede && [5, 6].indexOf(+ot.idestatuspresupuesto) < 0 && permiso.m" ng-hide="+fpago.id > 0">
                        <span class="glyphicon glyphicon-floppy-save"></span>
                    </button>
                    <button type="button" class="btn btn-info" ng-click="updFormaPago(fpago)" ng-disabled="frmDetPago.$invalid" ng-show="+fpago.id > 0 && [5, 6].indexOf(+ot.idestatuspresupuesto) < 0 && permiso.m">
                        <span class="glyphicon glyphicon-floppy-save"></span>
                    </button>
                </div>
            </form>
            <hr ng-show="sumporcentaje < 100"/>
            <table class="table table-hover table-condensed">
                <thead>
                <tr>
                    <th style="text-align: right">No.</th>
                    <!--<th style="text-align: right">%</th>-->
                    <th style="text-align: right">Monto</th>
                    <th style="text-align: right">Quitar I.S.R.</th>
                    <th>&nbsp;</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="det in lstdetpagos" ng-click="getFormaPago(det)">
                    <td style="text-align: right">{{det.nopago}}</td>
                    <!--<td style="text-align: right">{{det.porcentaje | number:4}}</td>-->
                    <td style="text-align: right">{{det.moneda}} {{det.monto | number:2}}</td>
                    <td style="text-align: right">{{+det.quitarisr == 0 ? 'No' : 'Sí'}}</td>
                    <td>
                        <button type="button" class="btn btn-danger btn-sm" ng-click="delFormaPago(det)" ng-show="permiso.e && [5, 6].indexOf(+ot.idestatuspresupuesto) < 0">
                            <span class="glyphicon glyphicon-trash"></span>
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="modal-footer">
            <!--<button class="btn btn-info" type="button" ng-click="ok()">Aceptar</button>-->
            <button class="btn btn-info" type="button" ng-click="cancel()">Terminar</button>
        </div>
    </script>
    <script type="text/ng-template" id="modalAnulaPresupuesto.html">
        <div class="modal-header">
            <h3 class="modal-title">Anulaci&oacute;n de presupuesto No. {{numpresup}}</h3>
        </div>
        <div class="modal-body" style="height: 200px; overflow-y: auto">
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="selRazonAnula">Raz&oacute;n:</label>
                        <select id="selRazonAnula" name="selRazonAnula" class="form-control" ng-model="params.idrazonanula" ng-options="obj.id as obj.razon for obj in razones" required></select>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12 text-right">
                    <span><strong>Usuario que anula: {{usr.nombre}}</strong></span>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-warning" type="button" ng-click="ok()" ng-disabled="params.idrazonanula == undefined || params.idrazonanula == null">Anular</button>
            <button class="btn btn-info" type="button" ng-click="cancel()">Cancelar</button>
        </div>
    </script>
    <script type="text/ng-template" id="modalAumentaExcedente.html">
        <div class="modal-header">
            <h3 class="modal-title">Cambio de porcentaje de excedente de Presupuesto</h3>
            <h4>Presupuesto No. {{!esot ? (presupuesto.id) : (presupuesto.idpresupuesto + '-' + presupuesto.correlativo)}}</h4>
        </div>
        <div class="modal-body" style="height: 200px; overflow-y: auto">
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="txtNuevoMonto">Porcentaje de excedente:</label>
                        <input id="txtNuevoMonto" name="txtNuevoMonto" type="number" class="form-control" ng-model="params.monto" step="0.01" required/>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-warning" type="button" ng-click="ok()" ng-disabled="params.monto == undefined || params.monto == null">Cambiar</button>
            <button class="btn btn-info" type="button" ng-click="cancel()">Cancelar</button>
        </div>
    </script>
    <script type="text/ng-template" id="modalAmpliarOt.html">
        <div class="modal-header">
            <h3 class="modal-title">Ampliaciones de OT No. {{ot.idpresupuesto}}-{{ot.correlativo}}</h3>
            <h4>
                Proveedor/beneficiario: {{ot.proveedor}}<br/>
                Sub-tipo de gasto: {{ot.subtipogasto}}<br/>
                Total de presupuesto: {{ot.moneda}}&nbsp;{{ot.total | number:2}}<br/>
                Monto de OT: {{ot.moneda}}&nbsp;{{ot.monto | number:2}}
            </h4>
        </div>
        <div class="modal-body" style="height: 500px; overflow-y: auto">
            <form name="frmAmpliacion" id="frmAmpliacion" ng-submit="frmAmpliacion.$valid && addAmpliacion(amplia)" novalidate>
                <div class="row">
                    <div class="col-md-3 nopadding">
                        <div class="form-group">
                            <label for="txtMontoAmpliacion">Monto:</label>
                            <input name="txtMontoAmpliacion" id="txtMontoAmpliacion" type="number" class="form-control input-sm" ng-model="amplia.monto" step="0.01" min="0.01" required/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 nopadding">
                        <div class="form-group">
                            <label for="txtNotasAmpliacion">Notas:</label>
                            <textarea name="txtNotasAmpliacion" id="txtNotasAmpliacion" class="form-control input-sm" rows="1" maxlength="1000" ng-model="amplia.notas" placeholder="Notas..." style="width: 100%"></textarea>
                        </div>
                    </div>
                </div>
                <div class="btn-group" role="group" aria-label="...">
                    <button type="submit" class="btn btn-info" ng-disabled="frmAmpliacion.$invalid" ng-show="permiso.m">
                        <span class="glyphicon glyphicon-floppy-save"></span>
                    </button>
                </div>
            </form>
            <hr ng-show="sumporcentaje < 100"/>
            <table class="table table-hover table-condensed">
                <thead>
                <tr>
                    <th style="text-align: right">No.</th>
                    <th style="text-align: right">Monto</th>
                    <th>Notas</th>
                    <th>&nbsp;</th>
                </tr>
                </thead>
                <tbody>
                <tr ng-repeat="det in lstampliaciones"
                ng-class="{presAprobado: +det.idestatuspresupuesto === 3, presPendiente: +det.idestatuspresupuesto === 2, presPendiente: +det.idestatuspresupuesto === 4}">
                    <td style="text-align: right">{{det.correlativoamplia}}</td>
                    <td style="text-align: right">{{det.monto | number:2}}</td>
                    <td><p>{{det.notas}}</p></td>
                    <td>
                        <button type="button" class="btn btn-danger btn-sm" ng-click="delAmpliacion(det)" ng-show="permiso.e">
                            <span class="glyphicon glyphicon-trash"></span>
                        </button>
                    </td>
                    <td>
                    <button class="btn btn-info btn-sm" type="button" ng-click="enviarRevision(det)" ng-show="permiso.e">
                        <span class="glyphicon glyphicon-share-alt"></span>
                    </button>
                    </td>
                </tr>
                <tr ng-show="lstampliaciones.length > 0">
                    <th style="text-align: right">Total:</th>
                    <th style="text-align: right">{{sumaAmpliaciones | number:2}}</th>
                    <td>&nbsp;</td>
                    <td>&nbsp;</td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="modal-footer">
            <!--<button class="btn btn-info" type="button" ng-click="enviarRevision()">Enviar a aprobación</button>-->
            <button class="btn btn-info" type="button" ng-click="cancel()">Terminar</button>
        </div>
    </script>
    <script type="text/ng-template" id="modalGroupPrint.html">
        <div class="modal-header">
            <h3 class="modal-title">Impresión de OTs</h3>
        </div>
        <div class="modal-body" style="overflow-y: auto;">
            <div class="row">
                <div class="col-md-5">
                    <div class="form-group">
                        <label for="txtFechaGenera">Fecha de generaci&oacute;n de cheque:</label>
                        <input name="txtFechaGenera" id="txtFechaGenera" type="date" class="form-control input-sm" ng-model="params.fecha" required/>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-info" type="button" ng-click="ok()" ng-disabled="!params.fecha">Generar</button>
            <button class="btn btn-info" type="button" ng-click="cancel()">Terminar</button>
        </div>
    </script>
    <script type="text/ng-template" id="modalAttachTo.html">
        <div class="modal-header">
            <h3 class="modal-title">Adherir OT {{ot.idpresupuesto}}-{{ot.correlativo}} a OTM</h3>
        </div>
        <div class="modal-body" style="overflow-y: auto;">
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="selOTMAtt">Seleccione la OTM a la que desea adherir la OT:</label>
                        <select name="selOTMAtt" id="selOTMAtt" class="form-control input-sm" ng-model="params.idpresupuesto" ng-options="obj.idpresupuesto as ('OTM-' + obj.idpresupuesto) for obj in otms" required>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-info" type="button" ng-click="ok()" ng-disabled="!params.idpresupuesto">Aceptar</button>
            <button class="btn btn-info" type="button" ng-click="cancel()">Cancelar</button>
        </div>
    </script>
</div>