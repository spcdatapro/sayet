<div class="container" ng-controller="ivaCtrl">
    <div class="panel panel-primary">
        <div class="panel-heading">Facturas con retenci&oacute;n de IVA</div>
        <div class="panel-body">
            <div class="row">
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="txtFDel">Fecha de factura del:</label>
                        <input name="txtFDel" id="txtFDel" type="date" class="form-control input-sm" ng-model="params.fdel"/>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="txtFAl">al:</label>
                        <input name="txtFAl" id="txtFAl" type="date" class="form-control input-sm" ng-model="params.fal"/>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label for="selVer">Ver:</label>
                        <select name="selVer" id="selVer" class="form-control input-sm" ng-model="params.cuales">
                            <option value="0">Todas</option>
                            <option value="1">Con formulario</option>
                            <option value="2">Sin formulario</option>
                        </select>
                    </div>
                </div>
                <div class="col-md-1">
                    <div class="btn-group">
                        <label for="btnGen">&nbsp;</label><br/>
                        <button name="btnGen" id="btnGen" class="btn btn-success btn-sm" ng-click="lstIva()" title="Ver facturas">
                            <span class="glyphicon glyphicon-ok"></span>
                        </button>
                        <button name="btnPdf" id="btnPdf" class="btn btn-primary btn-sm" ng-click="printPDF()" title="Descargar PDF">
                            <i class="fa fa-file-pdf-o" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>
            <hr/>
            <div class="row">
                <div class="col-md-12">
                    <table datatable="ng" dt-options="dtOptions" class="table table-condensed table-hover">
                        <thead>
                        <tr>                            
                            <th>Fecha</th>
                            <th>Factura</th>
                            <th>Proveedor</th>                            
                            <th>Sub-total</th>
                            <th>IVA</th>
                            <th>Total</th>
                            <th style="white-space: nowrap">Ret. IVA</th>
                            <th style="white-space: nowrap">Formulario</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="c in compras" ng-click="getCompra(c.id)">
                            <td>{{c.fecha | date:'dd/MM/yyyy'}}</td>
                            <td style="text-align: right">{{c.numero}}</td>
                            <td style="white-space: nowrap">({{c.nit}}) {{c.proveedor}}</td>
                            <td style="text-align: right">{{c.moneda}}.{{c.subtotal | number:2}}</td>
                            <td style="text-align: right">{{c.moneda}}.{{c.iva | number:2}}</td>
                            <td style="text-align: right">{{c.moneda}}.{{c.total | number:2}}</td>
                            <td style="text-align: right">{{c.moneda}}.{{c.retiva | number:2}}</td>
                            <td style="text-align: center">{{c.form}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="row" ng-show="sumaiva > 0">
                <div class="col-md-3 col-md-offset-5">
                    <div class="well well-sm" style="text-align: center">
                        <h3>
                            Total Ret. IVA Q.{{sumaiva | number:2}}
                        </h3>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/ng-template" id="modalIVA.html">
        <div class="modal-header">
            <h3 class="modal-title">Formulario de retenci&oacute;n IVA</h3>
            <h4 class="modal-title">{{compra.nomproveedor}}</h4>
            <h4 class="modal-title">Factura {{compra.serie}}&nbsp;{{compra.documento}}&nbsp;por&nbsp;{{compra.moneda}}&nbsp;{{compra.totfact | number:2}}</h4>
        </div>
        <div class="modal-body">
            <div class="form-group">
                <label for="txtNoFormISR">No. de formulario:</label>
                <input name="txtNoFormISR" id="txtNoFormISR" type="text" class="form-control" ng-model="compra.noformiva" maxlength="30"/>
            </div>
            <div class="form-group">
                <label for="txtNoAccISR">No. de acceso:</label>
                <input name="txtNoAccISR" id="txtNoAccISR" type="text" class="form-control" ng-model="compra.noaccesoiva" maxlength="30"/>
            </div>
            <div class="form-group">
                <label for="txtFecPagoISR">Fecha de pago:</label>
                <input name="txtFecPagoISR" id="txtFecPagoISR" type="date" class="form-control" ng-model="compra.fechaiva" ng-change="setMesAnio()"/>
            </div>
            <div class="form-group">
                <label for="txtMesISR">Mes:</label>
                <input name="txtMesISR" id="txtMesISR" type="number" class="form-control" ng-model="compra.mesiva" min="0" max="12" ng-disabled="true"/>
            </div>
            <div class="form-group">
                <label for="txtAnioISR">A&ntilde;o:</label>
                <input name="txtAnioISR" id="txtAnioISR" type="number" class="form-control" ng-model="compra.anioiva" min="2000" max="3000" ng-disabled="true"/>
            </div>
        </div>
        <div class="modal-footer">
            <button class="btn btn-primary" type="button" ng-click="ok()" ng-disabled="!compra.noformiva || !compra.noaccesoiva">Aceptar</button>
            <button class="btn btn-warning" type="button" ng-click="cancel()">Cancelar</button>
        </div>
    </script>
</div>